{"version":3,"file":"index.js","names":["React","useEffect","useMemo","useRef","BaseTabs","classNames","PropTypes","TabsDeprecated","Bubble","Dropdown","useIndexOfLastVisibleChild","Tab","MORE_TAB_TEXT","Tabs","_ref","children","className","moreTabText","defaultActiveKey","activeKey","props","_objectWithoutProperties","_excluded","containerElementRef","overflowElementRef","indexOfLastVisibleChild","current","parentNode","observer","MutationObserver","mutations","forEach","mutation","eventKey","target","getAttribute","isActive","element","querySelector","moreTab","classList","add","remove","observe","attributes","subtree","attributeFilter","disconnect","undefined","tabIndex","handleDropdownTabClick","hiddenTab","click","tabsChildren","indexOfOverflowStart","childrenList","Children","map","child","index","type","name","process","env","NODE_ENV","console","error","isValidElement","_child$props","title","notification","tabClassName","rest","_excluded2","newTitle","createElement","Fragment","variant","role","expandable","tabClass","modifiedTab","cloneElement","_objectSpread","moreTabHasNotification","overflowChildren","slice","overflowChild","Item","key","onClick","disabled","datakey","active","splice","length","ref","Toggle","id","Menu","_extends","propTypes","node","isRequired","string","defaultProps","Deprecated","default","TabContainer","TabContent","TabPane"],"sources":["../../src/Tabs/index.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from 'react';\nimport BaseTabs from 'react-bootstrap/Tabs';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport TabsDeprecated from './deprecated';\nimport Bubble from '../Bubble';\nimport Dropdown from '../Dropdown';\nimport useIndexOfLastVisibleChild from '../hooks/useIndexOfLastVisibleChild';\nimport Tab from './Tab';\n\nexport const MORE_TAB_TEXT = 'More...';\n\nfunction Tabs({\n  children,\n  className,\n  moreTabText = MORE_TAB_TEXT,\n  defaultActiveKey,\n  activeKey,\n  ...props\n}) {\n  const containerElementRef = useRef(null);\n  const overflowElementRef = useRef(null);\n  const indexOfLastVisibleChild = useIndexOfLastVisibleChild(\n    containerElementRef.current?.children[0],\n    overflowElementRef.current?.parentNode,\n  );\n\n  useEffect(() => {\n    if (containerElementRef.current) {\n      const observer = new MutationObserver((mutations => {\n        mutations.forEach(mutation => {\n          // React-Bootstrap attribute 'data-rb-event-key' is responsible for the tab identification\n          const eventKey = mutation.target.getAttribute('data-rb-event-key');\n          // React-Bootstrap attribute 'aria-selected' is responsible for selected/unselected state\n          const isActive = mutation.target.getAttribute('aria-selected') === 'true';\n          // datakey attribute is added manually to the dropdown\n          // elements so that they correspond to the native tabs' eventKey\n          const element = containerElementRef.current.querySelector(`[datakey='${eventKey}']`);\n          const moreTab = containerElementRef.current.querySelector('.pgn__tab_more');\n          if (isActive) {\n            element?.classList.add('active');\n            // Here we add active class to the 'More Tab' if element exists in the dropdown\n            if (element) {\n              moreTab.classList.add('active');\n            } else {\n              moreTab.classList.remove('active');\n            }\n          } else {\n            element?.classList.remove('active');\n          }\n        });\n      }));\n      observer.observe(containerElementRef.current, {\n        attributes: true, subtree: true, attributeFilter: ['aria-selected'],\n      });\n      return () => observer.disconnect();\n    }\n    return undefined;\n  }, []);\n\n  useEffect(() => {\n    if (overflowElementRef.current?.parentNode) {\n      overflowElementRef.current.parentNode.tabIndex = -1;\n    }\n  }, [overflowElementRef.current?.parentNode]);\n\n  const handleDropdownTabClick = (eventKey) => {\n    const hiddenTab = containerElementRef.current.querySelector(`[data-rb-event-key='${eventKey}']`);\n    hiddenTab.click();\n  };\n\n  const tabsChildren = useMemo(() => {\n    const indexOfOverflowStart = indexOfLastVisibleChild + 1;\n    const childrenList = React.Children.map(children, (child, index) => {\n      if (child?.type?.name !== 'Tab' && process.env.NODE_ENV === 'development') {\n        // eslint-disable-next-line no-console\n        console.error(\n          `Tabs children can only be of type Tab. ${children[index]} was passed instead.`,\n        );\n      }\n      if (!React.isValidElement(child)) {\n        return child;\n      }\n      const {\n        title, notification, tabClassName, ...rest\n      } = child.props;\n      let newTitle;\n      if (notification) {\n        newTitle = (\n          <>\n            {title}\n            <Bubble\n              variant=\"error\"\n              role=\"status\"\n              className=\"pgn__tab-notification\"\n              expandable\n            >\n              {notification}\n            </Bubble>\n          </>\n        );\n      } else {\n        newTitle = title;\n      }\n      const tabClass = index > indexOfLastVisibleChild ? 'pgn__tab_invisible' : '';\n      const modifiedTab = React.cloneElement(child, {\n        ...rest,\n        title: newTitle,\n        tabClassName: classNames(tabClass, tabClassName),\n      });\n      return modifiedTab;\n    });\n    let moreTabHasNotification = false;\n    const overflowChildren = childrenList.slice(indexOfOverflowStart)\n      .map(overflowChild => {\n        if (!moreTabHasNotification && overflowChild.props.notification) {\n          moreTabHasNotification = true;\n        }\n        return (\n          <Dropdown.Item\n            key={`${overflowChild.props.eventKey}overflow`}\n            onClick={() => handleDropdownTabClick(overflowChild.props.eventKey)}\n            disabled={overflowChild.props.disabled}\n            datakey={overflowChild.props.eventKey}\n            className={classNames({\n              active: overflowChild.props.eventKey === defaultActiveKey || overflowChild.props.eventKey === activeKey,\n            }, 'pgn__tabs__dropdown-item')}\n          >\n            {overflowChild.props.title}\n          </Dropdown.Item>\n        );\n      });\n\n    childrenList.splice(indexOfOverflowStart, 0, (<Tab\n      key=\"moreTabKey\"\n      tabClassName={classNames(!overflowChildren.length && 'pgn__tab_invisible', 'pgn__tab_more')}\n      title={(\n        <Dropdown ref={overflowElementRef}>\n          <Dropdown.Toggle\n            variant=\"link\"\n            className=\"nav-link\"\n            id=\"pgn__tab-toggle\"\n          >\n            {moreTabText}\n            {moreTabHasNotification && (\n              <Bubble\n                variant=\"error\"\n                role=\"status\"\n                className=\"pgn__tab-notification\"\n              />\n            )}\n          </Dropdown.Toggle>\n          <Dropdown.Menu className=\"dropdown-menu-right\">{overflowChildren}</Dropdown.Menu>\n        </Dropdown>\n      )}\n    />\n    ));\n    return childrenList;\n  }, [activeKey, children, defaultActiveKey, indexOfLastVisibleChild, moreTabText]);\n\n  return (\n    <div ref={containerElementRef}>\n      <BaseTabs\n        defaultActiveKey={defaultActiveKey}\n        activeKey={activeKey}\n        {...props}\n        className={classNames(className, 'pgn__tabs')}\n      >\n        {tabsChildren}\n      </BaseTabs>\n    </div>\n  );\n}\n\nTabs.propTypes = {\n  /** Specifies elements that is processed to create tabs. */\n  children: PropTypes.node.isRequired,\n  /** Specifies class name to append to the base element. */\n  className: PropTypes.string,\n  /** Specifies text for the 'More' tab. */\n  moreTabText: PropTypes.string,\n  /** Specifies default active tab (uncontrolled usage). */\n  defaultActiveKey: PropTypes.string,\n  /** Specifies active tab (controlled usage). */\n  activeKey: PropTypes.string,\n};\n\nTabs.defaultProps = {\n  className: undefined,\n  moreTabText: MORE_TAB_TEXT,\n  defaultActiveKey: undefined,\n  activeKey: undefined,\n};\n\nTabs.Deprecated = TabsDeprecated;\n\nexport default Tabs;\nexport { Tab };\nexport { default as TabContainer } from 'react-bootstrap/TabContainer';\nexport { default as TabContent } from 'react-bootstrap/TabContent';\nexport { default as TabPane } from 'react-bootstrap/TabPane';\n"],"mappings":"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"}