{"version":3,"file":"FormGroupContext.js","names":["React","useState","useEffect","useMemo","useCallback","PropTypes","classNames","newId","useIdList","omitUndefinedProperties","FORM_CONTROL_SIZES","identityFn","props","noop","FormGroupContext","createContext","getControlProps","useSetIsControlGroupEffect","getLabelProps","getDescriptorProps","hasFormGroupProvider","useFormGroupContext","useContext","useStateEffect","initialState","state","setState","useSetStateEffect","newState","FormGroupContextProvider","_ref","children","controlId","explicitControlId","isInvalid","isValid","size","describedByIds","registerDescriptorId","labelledByIds","registerLabelerId","isControlGroup","controlProps","labelledByIdsForControl","undefined","_objectSpread","id","labelProps","htmlFor","descriptorProps","contextValue","createElement","Provider","value","propTypes","node","isRequired","string","bool","oneOf","SMALL","LARGE","defaultProps"],"sources":["../../src/Form/FormGroupContext.jsx"],"sourcesContent":["import React, {\n  useState, useEffect, useMemo, useCallback,\n} from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { newId } from '../utils';\nimport { useIdList, omitUndefinedProperties } from './fieldUtils';\nimport { FORM_CONTROL_SIZES } from './constants';\n\nconst identityFn = props => props;\nconst noop = () => {};\n\nconst FormGroupContext = React.createContext({\n  getControlProps: identityFn,\n  useSetIsControlGroupEffect: noop,\n  getLabelProps: identityFn,\n  getDescriptorProps: identityFn,\n  hasFormGroupProvider: false,\n});\n\nconst useFormGroupContext = () => React.useContext(FormGroupContext);\n\nconst useStateEffect = (initialState) => {\n  const [state, setState] = useState(initialState);\n  const useSetStateEffect = (newState) => {\n    useEffect(() => setState(newState), [newState]);\n  };\n  return [state, useSetStateEffect];\n};\n\nfunction FormGroupContextProvider({\n  children,\n  controlId: explicitControlId,\n  isInvalid,\n  isValid,\n  size,\n}) {\n  const controlId = useMemo(() => explicitControlId || newId('form-field'), [explicitControlId]);\n  const [describedByIds, registerDescriptorId] = useIdList(controlId);\n  const [labelledByIds, registerLabelerId] = useIdList(controlId);\n  const [isControlGroup, useSetIsControlGroupEffect] = useStateEffect(false);\n\n  const getControlProps = useCallback((controlProps) => {\n    // labelledByIds from the list above should only be added to a control\n    // if it the control is a group. We prefer adding a condition here because:\n    //    - Hooks cannot be called inside conditionals\n    //    - The getLabelProps function below is forced to generate an id\n    //      whether it is needed or not.\n    //    - This is what allows consumers of Paragon to use <Form.Label>\n    //      interchangeably between ControlGroup type controls and regular Controls\n    const labelledByIdsForControl = isControlGroup ? labelledByIds : undefined;\n    return omitUndefinedProperties({\n      ...controlProps,\n      'aria-describedby': classNames(controlProps['aria-describedby'], describedByIds) || undefined,\n      'aria-labelledby': classNames(controlProps['aria-labelledby'], labelledByIdsForControl) || undefined,\n      id: controlId,\n    });\n  }, [\n    isControlGroup,\n    describedByIds,\n    labelledByIds,\n    controlId,\n  ]);\n\n  const getLabelProps = (labelProps) => {\n    const id = registerLabelerId(labelProps?.id);\n    if (isControlGroup) {\n      return { ...labelProps, id };\n    }\n    return { ...labelProps, htmlFor: controlId };\n  };\n\n  const getDescriptorProps = (descriptorProps) => {\n    const id = registerDescriptorId(descriptorProps?.id);\n    return { ...descriptorProps, id };\n  };\n\n  const contextValue = {\n    getControlProps,\n    getLabelProps,\n    getDescriptorProps,\n    useSetIsControlGroupEffect,\n    isControlGroup,\n    controlId,\n    isInvalid,\n    isValid,\n    size,\n    hasFormGroupProvider: true,\n  };\n\n  return (\n    <FormGroupContext.Provider value={contextValue}>\n      {children}\n    </FormGroupContext.Provider>\n  );\n}\n\nFormGroupContextProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n  controlId: PropTypes.string,\n  isInvalid: PropTypes.bool,\n  isValid: PropTypes.bool,\n  size: PropTypes.oneOf([\n    FORM_CONTROL_SIZES.SMALL,\n    FORM_CONTROL_SIZES.LARGE,\n  ]),\n};\n\nFormGroupContextProvider.defaultProps = {\n  controlId: undefined,\n  isInvalid: undefined,\n  isValid: undefined,\n  size: undefined,\n};\n\nexport {\n  FormGroupContext,\n  FormGroupContextProvider,\n  useFormGroupContext,\n};\n"],"mappings":"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"}